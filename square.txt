in
in
in
pop rcx
pop rbx
pop rax
call solve_dispetcher
hlt


solve_dispetcher:
    push 0
    push rax
    je call_solve_linear
    jne call_solve_square
    ret

call_solve_linear:
    call solve_linear
    ret

call_solve_square:
    call solve_square
    ret


check_infinity_or_no_solutions:
    push rcx
    push 0
    jne call_print_no_solve
    je call_print_infinity_solutions
    ret

call_print_no_solve:
    call print_no_solve
    ret

call_print_infinity_solutions:
    call print_infinity_solutions
    ret


solve_linear:
    push 0
    push rbx
    je call_check_infinity_or_no_solutions
    jne call_print_one_solutions
    ret

call_check_infinity_or_no_solutions:
    call check_infinity_or_no_solutions
    ret

call_print_one_solutions:
    call print_one_solutions
    push -1
    push rcx
    mul
    push rbx
    div
    out
    ret


solve_square:
    call discr
    push 0
    push rdx
    je call_discr_null
    jb call_print_no_solve

    push rdx
    sqrt
    pop rdx

    call print_two_solutions

    push -1
    push rbx
    mul
    push rdx
    sub
    push 2
    push rax
    mul
    div
    out

    push -1
    push rbx
    mul
    push rdx
    add
    push 2
    push rax
    mul
    div
    out
    ret

call_discr_null:
    CALL discr_null
    ret

call_print_no_solve:
    call print_no_solve
    ret


discr_null:
    call print_one_solutions

    push -1
    push rbx
    mul
    push 2
    push rax
    mul
    div
    out
    ret


discr:
    push rbx
    push rbx
    mul
    push 4
    push rax
    push rcx
    mul
    mul
    sub
    pop rdx
    ret


print_no_solve:
    push 78
    push 111
    push 32
    push 115
    push 111
    push 108
    push 117
    push 116
    push 105
    push 111
    push 110
    push 115
    outc 12
    ret


print_one_solutions:
    push 79
    push 110
    push 101
    push 32
    push 115
    push 111
    push 108
    push 117
    push 116
    push 105
    push 111
    push 110
    push 115
    outc 13
    ret


print_two_solutions:
    push 84
    push 119
    push 111
    push 32
    push 115
    push 111
    push 108
    push 117
    push 116
    push 105
    push 111
    push 110
    push 115
    outc 13
    ret


print_infinity_solutions:
    push 73
    push 110
    push 102
    push 105
    push 110
    push 105
    push 116
    push 121
    push 32
    push 115
    push 111
    push 108
    push 117
    push 116
    push 105
    push 111
    push 110
    push 115
    outc 18
    ret